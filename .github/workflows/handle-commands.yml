name: Обработка команд бота

on:
  workflow_dispatch:
    inputs:
      command:
        description: 'Команда от пользователя'
        required: true
      user_id:
        description: 'ID пользователя'
        required: true
      chat_id:
        description: 'Chat ID для ответа'
        required: true

jobs:
  process-command:
    runs-on: ubuntu-latest
    steps:
      - name: Обрабатываем команду
        run: |
          echo "Пользователь ${{ github.event.inputs.user_id }} отправил: ${{ github.event.inputs.command }}"
          
          case "${{ github.event.inputs.command }}" in
            "weather")
              echo "Нужно отправить текущую погоду"
              # Можно запустить daily-weather.yml с другим chat_id
              ;;
            "alerts")
              echo "Проверяем предупреждения"
              # Можно запустить weather-alerts.yml
              ;;
            "report")
              echo "Генерируем недельный отчет"
              # Можно запустить weekly-report.yml
              ;;
            "hourly")
              echo "Добавляем пользователя ${{ github.event.inputs.user_id }} в рассылку"
              # Сохраняем ID в файл
              echo "${{ github.event.inputs.user_id }}" >> subscribers.txt
              ;;
            "stop")
              echo "Удаляем пользователя ${{ github.event.inputs.user_id }} из рассылки"
              # Удаляем ID из файла
              sed -i "/${{ github.event.inputs.user_id }}/d" subscribers.txt
              ;;
          esac
